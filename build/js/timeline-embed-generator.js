function getScriptPath(e){for(var t=document.getElementsByTagName("script"),a="",d=0;d<t.length;d++)t[d].src.match(e)&&(a=t[d].src);return a.split("?")[0].split("/").slice(0,-1).join("/")+"/"}function getUrlVars(e){var t,a,d=[],m=e.toString();m.match("&#038;")?m=m.replace("&#038;","&"):m.match("&#38;")?m=m.replace("&#38;","&"):m.match("&amp;")&&(m=m.replace("&amp;","&")),m.match("#")&&(m=m.split("#")[0]),a=m.slice(m.indexOf("?")+1).split("&");for(var r=0;r<a.length;r++)t=a[r].split("="),d.push(t[0]),d[t[0]]=t[1];return d}function getLinkAndIframe(){var e,t,a,d={},m=document.getElementById("embed-source-url"),r=document.getElementById("embed-width"),n=document.getElementById("embed-height"),l=document.getElementById("embed-maptype"),o=document.getElementById("embed-language"),u=(document.getElementById("embed_code"),document.getElementById("embed-font")),c=document.getElementById("embed-startatend"),i=document.getElementById("embed-startzoomadjust"),g=document.getElementById("embed-startatslide"),p=document.getElementById("embed-debug"),h=document.getElementById("embed-googlemapkey"),s=!1,b=!1;return a=m.value.match("docs.google.com")?VCO.ConfigFactory.extractSpreadsheetKey(m.value):""==m.value?"0Agl_Dv6iEbDadHdKcHlHcTB5bzhvbF9iTWwyMmJHdkE":m.value,c.checked&&(s=!0),p.checked&&(b=!0),t=generator_embed_path+"?source="+a,t+="&font="+u.value,t+="&maptype="+l.value,t+="&lang="+o.value,s&&(t+="&start_at_end="+s),b&&(t+="&debug="+b),parseInt(g.value,10)>0&&(t+="&start_at_slide="+parseInt(g.value,10)),parseInt(i.value,10)>0&&(t+="&start_zoom_adjust="+parseInt(i.value,10)),""!=h.value&&(t+="&gmap_key="+h.value),r.value>0&&(t+="&width="+r.value),n.value>0&&(t+="&height="+n.value),e="<iframe src='"+t+"'",(r.value>0||r.value.match("%"))&&(e+=" width='"+r.value+"'"),(n.value>0||n.value.match("%"))&&(e+=" height='"+n.value+"'"),e+=" frameborder='0'></iframe>",d.iframe=e,d.link=t,d.copybox=e,d}function updateEmbedCode(){var e=document.getElementById("embed_code"),t=getLinkAndIframe();e.value=t.copybox,jQuery("#preview-embed-link").attr("href",t.link),jQuery("#preview-embed-iframe").html(t.iframe),jQuery("#preview-embed").css("display","block")}if("undefined"==typeof generator_embed_path||"undefined"==typeof generator_embed_path){var generator_embed_path=getScriptPath("timeline-embed-generator.js").split("js/")[0];generator_embed_path.match("http")?generator_embed_path=generator_embed_path:"/"==generator_embed_path?generator_embed_path="index.html":generator_embed_path+="index.html"}