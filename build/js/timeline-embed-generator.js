function getScriptPath(e){for(var t=document.getElementsByTagName("script"),a="",m=0;m<t.length;m++)t[m].src.match(e)&&(a=t[m].src);return a.split("?")[0].split("/").slice(0,-1).join("/")+"/"}function getUrlVars(e){var t,a,m=[],d=e.toString();d.match("&#038;")?d=d.replace("&#038;","&"):d.match("&#38;")?d=d.replace("&#38;","&"):d.match("&amp;")&&(d=d.replace("&amp;","&")),d.match("#")&&(d=d.split("#")[0]),a=d.slice(d.indexOf("?")+1).split("&");for(var r=0;r<a.length;r++)t=a[r].split("="),m.push(t[0]),m[t[0]]=t[1];return m}function getLinkAndIframe(){var e,t,a,m={},d=document.getElementById("embed-source-url"),r=document.getElementById("embed-width"),n=document.getElementById("embed-height"),l=document.getElementById("embed-maptype"),o=document.getElementById("embed-language"),u=(document.getElementById("embed_code"),document.getElementById("embed-font")),c=document.getElementById("embed-startatend"),g=document.getElementById("embed-startzoomadjust"),i=document.getElementById("embed-startatslide"),p=document.getElementById("embed-debug"),h=document.getElementById("embed-googlemapkey"),s=!1,b=!1;return a=d.value.match("docs.google.com")?VCO.ConfigFactory.extractSpreadsheetKey(d.value):""==d.value?document.getElementById("embed-source-url").getAttribute("placeholder"):d.value,c.checked&&(s=!0),p.checked&&(b=!0),t=generator_embed_path+"?source="+a,t+="&font="+u.value,t+="&maptype="+l.value,t+="&lang="+o.value,s&&(t+="&start_at_end="+s),b&&(t+="&debug="+b),parseInt(i.value,10)>0&&(t+="&start_at_slide="+parseInt(i.value,10)),parseInt(g.value,10)>0&&(t+="&start_zoom_adjust="+parseInt(g.value,10)),""!=h.value&&(t+="&gmap_key="+h.value),r.value>0&&(t+="&width="+r.value),n.value>0&&(t+="&height="+n.value),e="<iframe src='"+t+"'",(r.value>0||r.value.match("%"))&&(e+=" width='"+r.value+"'"),(n.value>0||n.value.match("%"))&&(e+=" height='"+n.value+"'"),e+=" frameborder='0'></iframe>",m.iframe=e,m.link=t,m.copybox=e,m}function updateEmbedCode(){var e=document.getElementById("embed_code"),t=getLinkAndIframe();console.log(t),e.value=t.copybox,jQuery("#preview-embed-link").attr("href",t.link),jQuery("#preview-embed-iframe").html(t.iframe),jQuery("#preview-embed").css("display","block")}if("undefined"==typeof generator_embed_path||"undefined"==typeof generator_embed_path){var generator_embed_path=getScriptPath("timeline-embed-generator.js").split("js/")[0];generator_embed_path.match("http")?generator_embed_path=generator_embed_path:"/"==generator_embed_path?generator_embed_path="index.html":generator_embed_path+="index.html"}